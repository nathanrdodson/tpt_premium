document.__tieredPricing={activeInstances:[],initFunction:void 0,overrides:{}},jQuery(document).ready(function($){if(void 0===tieredPricingGlobalData)return;function TieredPriceTable(isTooltip=!1){this.productPageManager=null,this.dataProvider=null,this.isTooltip=isTooltip,this.init=function($wrapper){this.$wrapper=$wrapper,this.productPageManager.bindEvents(),this.isTooltip&&(jQuery.widget.bridge("uiTooltip",jQuery.ui.tooltip),this.dataProvider.isVariableProduct()||this.initTooltip())},this.$getPricingElement=function(){return this.$wrapper.find("[data-tiered-pricing-table]")},this.$getPricingElementPart=function(){return this.$wrapper.find("[data-tiered-pricing-table]").find("tbody").find("tr")},this.initTooltip=function(){this.dataProvider.isTooltipBorder()&&this.$getPricingElement().css("border","2px solid "+this.dataProvider.getActiveTierColor()),jQuery(document).uiTooltip({items:".tiered-pricing-tooltip-icon",tooltipClass:"tiered-pricing-tooltip",content:function(){return this.productPageManager.$getQuantityField().trigger("change"),this.$getPricingElement().clone()}.bind(this),hide:{effect:"fade"},position:{my:"center bottom-40",at:"center bottom",using:function(position){jQuery(this).css(position)}},close:function(e,tooltip){tooltip.tooltip.innerHTML=""}})}}function HorizontalTieredPricingTable(){this.productPageManager=null,this.dataProvider=null,this.init=function($wrapper){this.$wrapper=$wrapper,this.productPageManager.bindEvents()},this.$getPricingElement=function(){return this.$wrapper.find(".tiered-pricing-horizontal-table")},this.$getPricingElementPart=function(){return this.$wrapper.find(".tiered-pricing-horizontal-table__values")}}function TieredPricingPlainText(){this.productPageManager=null,this.dataProvider=null,this.init=function($wrapper){this.$wrapper=$wrapper,this.productPageManager.bindEvents()},this.$getPricingElement=function(){return this.$wrapper.find(".tiered-pricing-plain-texts")},this.$getPricingElementPart=function(){return this.$wrapper.find(".tiered-pricing-plain-text")}}function TieredPricingDropdown(){this.isExpanded=!1,this.$selectedElement=null,this.productPageManager=null,this.dataProvider=null,this.$getList=function(){return this.$wrapper.find(".tiered-pricing-dropdown__list")},this.$getSelectBox=function(){return this.$wrapper.find(".tiered-pricing-dropdown__select-box")},this.init=function($wrapper){this.$wrapper=$wrapper,this.productPageManager.bindEvents(),jQuery(document).on("click",".tiered-pricing-dropdown__select-box",this.handleSelectBoxClick.bind(this)),jQuery(document).on("click",this.hide.bind(this)),jQuery(".tpt__tiered-pricing").on("tiered_price_update",this.update.bind(this)),jQuery(document).on("keyup",this.$wrapper,function(e){13!==e.which&&32!==e.which||this.show()}.bind(this))},this.setActiveElement=function(el){this.$selectedElement=el,this.$getList().find(".tiered-pricing-dropdown-option").removeClass("tiered-pricing-dropdown-option--selected"),this.$selectedElement.addClass("tiered-pricing-dropdown-option--selected"),this.$getSelectBox().find(".tiered-pricing-dropdown-option").html(el.html())},this.update=function(){var activeEl=this.$getPricingElementPart().filter(".tiered-pricing--active");activeEl.length&&this.setActiveElement(activeEl)},this.handleSelectBoxClick=function(e){jQuery(e.target).closest(this.$wrapper).length&&(e.stopPropagation(),this.isExpanded?this.hide():this.show())},this.show=function(){this.$getList().show(),this.$getSelectBox().addClass("tiered-pricing-dropdown__select-box--active"),this.isExpanded=!0},this.hide=function(){this.isExpanded&&(this.$getList().hide(),this.$getSelectBox().removeClass("tiered-pricing-dropdown__select-box--active"),this.isExpanded=!1)},this.$getPricingElement=function(){return this.$wrapper.find(".tiered-pricing-dropdown")},this.$getPricingElementPart=function(){return this.$wrapper.find(".tiered-pricing-dropdown__list .tiered-pricing-dropdown-option")}}function TieredPricingBlocks(){this.productPageManager=null,this.dataProvider=null,this.init=function($wrapper){this.$wrapper=$wrapper,this.productPageManager.bindEvents()},this.$getPricingElement=function(){return this.$wrapper.find(".tiered-pricing-blocks")},this.$getPricingElementPart=function(){return this.$wrapper.find(".tiered-pricing-blocks").find(".tiered-pricing-block")}}function TieredPricingOptions(){this.productPageManager=null,this.dataProvider=null,this.init=function($wrapper){this.$wrapper=$wrapper,this.productPageManager.bindEvents(),this.dataProvider.isPremium()&&jQuery(".tpt__tiered-pricing").on("tiered_price_update",this.updateTotals.bind(this))},this.updateTotals=function(event,data){var originalTotal,discountedTotal;data.parentId===this.dataProvider.getParentId()&&((originalTotal=jQuery("<del>")).html(data.__instance.formatting.formatPrice(data.__instance.dataProvider.getRegularPrice()*data.quantity)),discountedTotal=data.__instance.formatting.formatPrice(data.price*data.quantity),data.__instance.dataProvider.getRegularPrice()!==data.price?this.$getPricingElementPart().find(".tiered-pricing-option-total__original_total").html(originalTotal):this.$getPricingElementPart().find(".tiered-pricing-option-total__original_total").html(""),this.$getPricingElementPart().find(".tiered-pricing-option-total__discounted_total").html(discountedTotal))},this.$getPricingElement=function(){return this.$wrapper.find(".tiered-pricing-options")},this.$getPricingElementPart=function(){return this.$wrapper.find(".tiered-pricing-option")}}function ProductPageManager(tieredPricingInstance){this.tieredPricingInstance=tieredPricingInstance,this.bindEvents=function(){var variationWrap;this.$getQuantityField().on("change input",function(event){this.updatePricingByQuantity(jQuery(event.target).val())}.bind(this)),this.tieredPricingInstance.dataProvider.isClickableRows()&&jQuery(document).on("click",tieredPricingInstance.$getPricingElementPart(),this.setQuantityByClick.bind(this)),this.tieredPricingInstance.dataProvider.isVariableProduct()&&!this.tieredPricingInstance.dataProvider.isVariableProductSamePrices()&&((0<(variationWrap=this.tieredPricingInstance.$wrapper.closest(".product").find(".single_variation_wrap")).length?variationWrap:jQuery(document)).on("show_variation",this.loadVariationPricing.bind(this)),jQuery(document).on("reset_data",this.resetVariationData.bind(this)))},this.resetVariationData=function(e){0!==jQuery(e.target).closest(".product").find(this.tieredPricingInstance.$wrapper).length&&(this.tieredPricingInstance.dataProvider.updatePriceSuffix(""),this.tieredPricingInstance.$wrapper.html(""),this.$getPriceContainer().length)&&this.defaultVariableProductPrice&&this.updateProductPriceHTML(this.defaultVariableProductPrice,!0)},this.$getPriceContainer=function(){const productId=this.tieredPricingInstance.dataProvider.getProductId(),parentId=this.tieredPricingInstance.dataProvider.getParentId();return"function"==typeof document.__tieredPricing.overrides.$getPriceContainer?document.__tieredPricing.overrides.$getPriceContainer(productId,parentId,this):"undefined"!=typeof tieredPriceTableGetProductPriceContainer?tieredPriceTableGetProductPriceContainer():jQuery(".tiered-pricing-dynamic-price-wrapper").filter(function(index,container){var container=jQuery(container),containerProductId=parseInt(container.data("product-id")),container=parseInt(container.data("parent-id"));return containerProductId===container?container===parentId:containerProductId===productId})},this.$getQuantityField=function(){var parentId=this.tieredPricingInstance.dataProvider.getParentId();if("function"==typeof document.__tieredPricing.overrides.$getQuantityField)return document.__tieredPricing.overrides.$getQuantityField(parentId,this);let $quantityField=jQuery(".quantity-input-product-"+parentId);return($quantityField=0===$quantityField.length?this.tieredPricingInstance.$wrapper.closest(".product").find("[name=quantity]"):$quantityField).length,$quantityField},this.loadVariationPricing=function(event,variation){jQuery.post(document.location.origin+document.location.pathname+"?wc-ajax=get_pricing_table",{variation_id:variation.variation_id,nonce:tieredPricingGlobalData.loadVariationTieredPricingNonce,display_context:this.tieredPricingInstance.dataProvider.getDisplayContext()},function(response){tieredPricingInstance.$wrapper.html(response),response?(this.$getQuantityField().trigger("change"),"tooltip"===this.tieredPricingInstance.dataProvider.getDisplayType()&&this.tieredPricingInstance.initTooltip()):(variation.price_html&&this.updateProductPriceHTML(variation.price_html,!0),variation.min_qty&&0<variation.min_qty&&this.$getQuantityField().val(variation.min_qty)),"tooltip"===this.tieredPricingInstance.dataProvider.getDisplayType()&&this.tieredPricingInstance.dataProvider.isTooltipBorder()&&this.tieredPricingInstance.$getPricingElement().css("border","2px solid "+this.tieredPricingInstance.dataProvider.getActiveTierColor())}.bind(this))},this.setQuantityByClick=function(e){var e=jQuery(e.target).closest(tieredPricingInstance.$getPricingElementPart());0<e.length&&(0<(e=parseInt(e.data("tiered-quantity")))&&this.$getQuantityField().val(e),this.$getQuantityField().trigger("change"))},this.updatePricingByQuantity=function(quantity){this.resetPricingElementActive(),quantity=Math.max(1,quantity);var pricing=this.tieredPricingInstance.dataProvider.getPricingByQuantity(quantity);pricing&&(this.tieredPricingInstance.dataProvider.updatePriceOnProductPage()&&this.updateProductPriceHTML(this.buildProductPagePrice(pricing),!0),this.setPricingElementActive(pricing.tieredQuantity),this.tieredPricingInstance.$wrapper.trigger("tiered_price_update",{pricing:pricing,quantity:quantity,price:pricing.price,price_excl_tax:pricing.price_excl_tax,productId:this.tieredPricingInstance.dataProvider.getProductId(),parentId:this.tieredPricingInstance.dataProvider.getParentId(),__instance:tieredPricingInstance}))},this.buildProductPagePrice=function(pricing){var showAsADiscount=this.tieredPricingInstance.dataProvider.showTieredPriceAsDiscount()&&pricing.tieredQuantity>this.tieredPricingInstance.dataProvider.getMinimum();let price,originalPrice,priceSuffix,multiplyBy;return multiplyBy=1,this.tieredPricingInstance.dataProvider.isShowTotalPrice()&&1<pricing.eventQuantity&&(multiplyBy=pricing.eventQuantity),price=pricing.price*multiplyBy,priceSuffix=this.buildPriceSuffix(pricing,multiplyBy),this.tieredPricingInstance.dataProvider.isProductOnSale()?originalPrice=this.tieredPricingInstance.dataProvider.getRegularPrice()*multiplyBy:showAsADiscount&&(originalPrice=this.tieredPricingInstance.dataProvider.getOriginalPrice()*multiplyBy),formatting.formatPrice(price,originalPrice,priceSuffix)},this.buildPriceSuffix=function(pricing,quantity=1){let suffix=this.tieredPricingInstance.dataProvider.getPriceSuffix();var suffixWrapper;return suffix&&((suffixWrapper=jQuery("<div>")).html(suffix),0<suffixWrapper.find(".tiered-pricing-dynamic-price__excluding_tax").length&&suffixWrapper.find(".tiered-pricing-dynamic-price__excluding_tax").replaceWith(formatting.formatPrice(pricing.price_excl_tax*quantity)),0<suffixWrapper.find(".tiered-pricing-dynamic-price__including_tax").length&&suffixWrapper.find(".tiered-pricing-dynamic-price__including_tax").replaceWith(formatting.formatPrice(pricing.price_incl_tax*quantity)),suffix=suffixWrapper.html()),suffix},this.updateProductPriceHTML=function(priceHtml){this.defaultVariableProductPrice||(this.defaultVariableProductPrice=this.$getPriceContainer().first().html()),this.$getPriceContainer().each(function(index,container){container=jQuery(container);"dynamic"===container.data("price-type")&&container.html(priceHtml)})},this.setPricingElementActive=function(quantity){this.tieredPricingInstance.$getPricingElement().find('[data-tiered-quantity="'+quantity+'"]').addClass("tiered-pricing--active")},this.resetPricingElementActive=function(){this.tieredPricingInstance.$getPricingElement().find("[data-tiered-quantity]").removeClass("tiered-pricing--active")},setTimeout(function(){this.$getQuantityField().trigger("change")}.bind(this),300)}function DataProvider(tieredPricingInstance){this.tieredPricingInstance=tieredPricingInstance,this.settings=null,this.getSettings=function(){return this.settings||(this.settings=tieredPricingInstance.$wrapper.data("settings")),this.settings},this.isVariableProduct=function(){return tieredPricingGlobalData.supportedVariableProductTypes.includes(this.getProductType())},this.getPricingByQuantity=function(quantity){if(0<this.tieredPricingInstance.$getPricingElement().length){var tieredQuantity,pricing={price:this.getPriceByTieredQuantity(0),price_excl_tax:this.getPriceByTieredQuantity(0,"excl_tax"),price_incl_tax:this.getPriceByTieredQuantity(0,"incl_tax"),priceHtml:this.getPriceByTieredQuantity(0,"html"),tieredQuantity:this.getMinimum(),eventQuantity:quantity};for(tieredQuantity in this.getPricingRules())if(quantity>=(tieredQuantity=parseInt(tieredQuantity))){pricing.price=this.getPriceByTieredQuantity(tieredQuantity),pricing.price_excl_tax=this.getPriceByTieredQuantity(tieredQuantity,"excl_tax"),pricing.price_incl_tax=this.getPriceByTieredQuantity(tieredQuantity,"incl_tax"),pricing.priceHtml=this.getPriceByTieredQuantity(tieredQuantity,"html"),pricing.tieredQuantity=tieredQuantity,pricing.eventQuantity=quantity;break}return pricing}return!1},this.getPricingRules=function(){let rawPricingRules=JSON.parse(this.tieredPricingInstance.$getPricingElement().attr("data-price-rules"));return Object.keys(rawPricingRules).sort((a,b)=>a-b).reverse().reduce((obj,key)=>(obj[key+" "]=rawPricingRules[key],obj),{})},this.getMinimum=function(){var min=this.tieredPricingInstance.$getPricingElement().data("minimum");return min?parseInt(min):1},this.getProductName=function(){return this.tieredPricingInstance.$getPricingElement().data("product-name")},this.getPriceSuffix=function(){return"undefined"!=typeof tieredPriceTableGetProductPriceSuffix?tieredPriceTableGetProductPriceSuffix():this.tieredPricingInstance.$getPricingElement().data("product-price-suffix")},this.updatePriceSuffix=function(suffix){this.tieredPricingInstance.$getPricingElement().attr("data-product-price-suffix",suffix)},this.getProductType=function(){return this.tieredPricingInstance.$wrapper.data("product-type")},this.isVariableProductSamePrices=function(){return"yes"===this.tieredPricingInstance.$wrapper.data("variable-product-same-prices")},this.getProductId=function(){return parseInt(this.tieredPricingInstance.$getPricingElement().data("product-id"))},this.getParentId=function(){return parseInt(this.tieredPricingInstance.$wrapper.data("product-id"))},this.getPriceByTieredQuantity=function(tieredQuantity,type="regular"){tieredQuantity=tieredQuantity||this.getMinimum();var pricingElement=this.tieredPricingInstance.$getPricingElement().find('[data-tiered-quantity="'+tieredQuantity+'"]');return!(pricingElement.length<1)&&("html"===type?formatting.formatPrice(this.getPriceByTieredQuantity(tieredQuantity,"regular")):"excl_tax"===type?parseFloat(pricingElement.data("tiered-price-exclude-taxes")):"incl_tax"===type?parseFloat(pricingElement.data("tiered-price-include-taxes")):parseFloat(pricingElement.data("tiered-price")))},this.isClickableRows=function(){return this.isPremium()&&this.getSettings().clickable_rows},this.isShowTotalPrice=function(){return this.isPremium()&&this.getSettings().show_total_price},this.isTooltipBorder=function(){return this.getSettings().tooltip_border},this.getDisplayType=function(){return this.getSettings().display_type},this.getActiveTierColor=function(){return this.getSettings().active_tier_color},this.updatePriceOnProductPage=function(){return this.getSettings().update_price_on_product_page},this.showTieredPriceAsDiscount=function(){return this.getSettings().show_tiered_price_as_discount},this.isProductOnSale=function(){return""!==this.tieredPricingInstance.$getPricingElement().data("sale-price")},this.getRegularPrice=function(){return parseFloat(this.tieredPricingInstance.$getPricingElement().data("regular-price"))},this.getSalePrice=function(){return parseFloat(this.tieredPricingInstance.$getPricingElement().data("sale-price"))},this.getOriginalPrice=function(){return parseFloat(this.tieredPricingInstance.$getPricingElement().data("price"))},this.isPremium=function(){return"yes"===tieredPricingGlobalData.isPremium},this.getDisplayContext=function(){return this.tieredPricingInstance.$wrapper.data("display-context")}}const formatting=new function(currencyOptions){this.currencyOptions=currencyOptions,this.formatNumber=function(number,decimals,dec_point,thousands_sep,trim_zeros){let i,j,kw,kd,km;return isNaN(decimals=Math.abs(decimals))&&(decimals=this.currencyOptions.decimals),void 0===dec_point&&(dec_point=this.currencyOptions.decimal_separator),void 0===thousands_sep&&(thousands_sep=this.currencyOptions.thousand_separator),void 0===trim_zeros&&(trim_zeros=this.currencyOptions.trim_zeros),i=parseInt(number=(+number||0).toFixed(decimals))+"",3<(j=i.length)?j%=3:j=0,km=j?i.substr(0,j)+thousands_sep:"",kw=i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+thousands_sep),kd=decimals?dec_point+Math.abs(number-i).toFixed(decimals).replace(/-/,0).slice(2):"",trim_zeros?(kd=kd.replace(/0+$/,""),thousands_sep=new RegExp("\\"+dec_point+"+$"),(km+kw+kd).replace(thousands_sep,"")):km+kw+kd},this.formatPrice=function(price,originalPrice="",suffix=""){var currency='<span class="woocommerce-Price-currencySymbol">'+this.currencyOptions.currency_symbol+"</span>",priceSuffixPart=suffix?" %3$s ":"";let template;return template=originalPrice?"<del>"+this.formatPrice(originalPrice)+'</del> <ins><span class="woocommerce-Price-amount amount">'+this.currencyOptions.price_format+priceSuffixPart+"</span></ins>":'<span class="woocommerce-Price-amount amount">'+this.currencyOptions.price_format+priceSuffixPart+"</span>",jQuery("<textarea />").html(template.replace("%2$s",this.formatNumber(price)).replace("%1$s",currency).replace("%3$s",suffix)).text()}}(tieredPricingGlobalData.currencyOptions);document.__tieredPricing.initFunction=function(wrapper){var displayType=jQuery(wrapper).data("display-type");let tieredPricingInstance=null;return"options"===displayType?tieredPricingInstance=new TieredPricingOptions:"plain-text"===displayType?tieredPricingInstance=new TieredPricingPlainText:"blocks"===displayType?tieredPricingInstance=new TieredPricingBlocks:"dropdown"===displayType?tieredPricingInstance=new TieredPricingDropdown:"horizontal-table"===displayType?tieredPricingInstance=new HorizontalTieredPricingTable:"table"!==displayType&&"tooltip"!==displayType||(tieredPricingInstance=new TieredPriceTable("tooltip"===displayType)),tieredPricingInstance?(tieredPricingInstance.formatting=formatting,tieredPricingInstance.dataProvider=new DataProvider(tieredPricingInstance),tieredPricingInstance.productPageManager=new ProductPageManager(tieredPricingInstance),tieredPricingInstance.init(jQuery(wrapper)),document.__tieredPricing.activeInstances.push(tieredPricingInstance),tieredPricingInstance):null},setTimeout(function(){jQuery.each(jQuery(".tpt__tiered-pricing"),function(index,wrapper){document.__tieredPricing.initFunction(wrapper)})},200),jQuery,jQuery(".tpt__tiered-pricing").on("tiered_price_update",function(event,data){var productId=data.parentId;let summaryTable;(summaryTable=productId?jQuery(".tier-pricing-summary-table").filter("[data-product-id="+productId+"]"):jQuery(".tier-pricing-summary-table")).length<1||(summaryTable.removeClass("tier-pricing-summary-table--hidden"),summaryTable.find("[data-tier-pricing-table-summary-product-qty]").text(data.__instance.formatting.formatNumber(data.quantity,0)),summaryTable.find("[data-tier-pricing-table-summary-product-price]").html(data.__instance.formatting.formatPrice(data.price,!1)),summaryTable.find("[data-tier-pricing-table-summary-total]").html(data.__instance.formatting.formatPrice(data.price*data.quantity)),summaryTable.find("[data-tier-pricing-table-summary-total-with-tax]").html(data.__instance.formatting.formatPrice(data.price*data.quantity,"",data.__instance.productPageManager.buildPriceSuffix(data.pricing,data.quantity))),productId=data.__instance.dataProvider.getRegularPrice(),data.price!==productId?summaryTable.find("[data-tier-pricing-table-summary-product-old-price]").html(data.__instance.formatting.formatPrice(data.__instance.dataProvider.getRegularPrice())):summaryTable.find("[data-tier-pricing-table-summary-product-old-price]").html(""),summaryTable.find("[data-tier-pricing-table-summary-product-name]").html(data.__instance.dataProvider.getProductName()))}),jQuery(document).on("reset_data",function(e,data){e=jQuery(e.target);let productId=0;((productId=e.length?e.find(".tpt__tiered-pricing").data("product-id"):productId)?jQuery(".tier-pricing-summary-table").filter("[data-product-id="+productId+"]"):jQuery(".tier-pricing-summary-table")).addClass("tier-pricing-summary-table--hidden")}),jQuery(document).on("found_variation",function(e,data){data=data.parent_id||0;(data?jQuery(".tier-pricing-summary-table").filter("[data-product-id="+data+"]"):jQuery(".tier-pricing-summary-table")).addClass("tier-pricing-summary-table--hidden")}),jQuery,jQuery(".tpt__tiered-pricing").on("tiered_price_update",function(event,data){let originalPrice,saveAmount;jQuery.each(jQuery(".tiered-pricing-you-save"),function(i,el){var elementProductId=jQuery(el).data("product-id"),elementParentId=jQuery(el).data("parent-id");if(elementProductId===elementParentId){if(elementParentId!==data.parentId)return}else if(data.productId!==jQuery(el).data("product-id"))return;elementProductId=jQuery(el),elementParentId="yes"===elementProductId.data("consider-sale-price");originalPrice=elementParentId?data.__instance.dataProvider.getRegularPrice():data.__instance.dataProvider.getOriginalPrice(),0<(saveAmount=originalPrice-data.price)?(elementProductId.removeClass("tiered-pricing-you-save--hidden"),elementProductId.find(".tiered-pricing-you-save__price").html(data.__instance.formatting.formatPrice(saveAmount)),elementProductId.find(".tiered-pricing-you-save__total").html(data.__instance.formatting.formatPrice(saveAmount*data.quantity))):elementProductId.addClass("tiered-pricing-you-save--hidden")})}),jQuery(document).on("reset_data",function(e){e=jQuery(e.target);let productId=0;((productId=e.length?e.closest(".product").find(".tpt__tiered-pricing").data("product-id"):productId)?jQuery(".tiered-pricing-you-save").filter("[data-product-id="+productId+"]"):jQuery(".tiered-pricing-you-save")).addClass("tiered-pricing-you-save--hidden")}),jQuery(document).on("found_variation",function(e,data){data=data.parent_id||0;(data?jQuery(".tiered-pricing-you-save").filter("[data-product-id="+data+"]"):jQuery(".tiered-pricing-you-save")).addClass("tiered-pricing-you-save--hidden")})});
